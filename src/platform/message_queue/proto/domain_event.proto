syntax = "proto3";

package ticketing.events;

// Base domain event structure
message MqDomainEvent {
  string event_id = 1;
  string event_type = 2;
  string aggregate_id = 3;
  string aggregate_type = 4;
  int64 occurred_at = 5;  // Unix timestamp
  map<string, string> metadata = 6;
  bytes data = 7;  // Serialized event data
}

// Ticket reservation successful event
message TicketsReservedEvent {
  string buyer_id = 1;
  string booking_id = 2;
  repeated string ticket_ids = 3;
  string event_id = 4;
  int32 quantity = 5;
  double total_price = 6;
}

// Ticket reservation failed event
message TicketReservationFailedEvent {
  string request_id = 1;
  string buyer_id = 2;
  string event_id = 3;
  string error_code = 4;
  string error_message = 5;
  int32 requested_quantity = 6;
}

// Booking payment successful event
message BookingPaidEvent {
  string booking_id = 1;
  string buyer_id = 2;
  string payment_id = 3;
  double amount = 4;
  string currency = 5;
  int64 paid_at = 6;
}

// Booking cancelled event
message BookingCancelledEvent {
  string booking_id = 1;
  string buyer_id = 2;
  string reason = 3;
  int64 cancelled_at = 4;
  repeated string refunded_ticket_ids = 5;
}
